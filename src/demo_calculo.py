#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Demonstra√ß√£o dos C√°lculos da Calculadora de Apostas
Exemplo pr√°tico: Cruzeiro vs Internacional
"""

import math

def calcular_exemplo_completo():
    """Demonstra os c√°lculos com dados reais"""
    
    print("="*80)
    print("DEMONSTRA√á√ÉO: CRUZEIRO vs INTERNACIONAL")
    print("="*80)
    
    # Dados dos times (do CSV fornecido)
    cruzeiro = {
        'nome': 'Cruzeiro',
        'gols_marcados': 1.6,
        'gols_sofridos': 0.7,
        'posicao': 'Casa'
    }
    
    internacional = {
        'nome': 'Internacional', 
        'gols_marcados': 1.2,
        'gols_sofridos': 1.4,
        'posicao': 'Visitante'
    }
    
    # Configura√ß√µes
    media_liga = 1.2
    fator_casa = 1.15
    
    # Odds da casa
    odds = {
        'cruzeiro': 2.15,
        'empate': 3.10,
        'internacional': 3.75
    }
    
    print(f"üìä DADOS DOS TIMES:")
    print(f"‚Ä¢ {cruzeiro['nome']} ({cruzeiro['posicao']}):")
    print(f"  - Gols marcados: {cruzeiro['gols_marcados']:.1f}/jogo")
    print(f"  - Gols sofridos: {cruzeiro['gols_sofridos']:.1f}/jogo")
    print(f"‚Ä¢ {internacional['nome']} ({internacional['posicao']}):")
    print(f"  - Gols marcados: {internacional['gols_marcados']:.1f}/jogo") 
    print(f"  - Gols sofridos: {internacional['gols_sofridos']:.1f}/jogo")
    
    print(f"\n‚öôÔ∏è CONFIGURA√á√ïES:")
    print(f"‚Ä¢ M√©dia da liga: {media_liga} gols/time/jogo")
    print(f"‚Ä¢ Fator casa: {fator_casa}")
    
    # C√°lculo das for√ßas
    print(f"\nüî¢ C√ÅLCULO DAS FOR√áAS:")
    
    forca_of_cru = cruzeiro['gols_marcados'] / media_liga
    forca_def_cru = cruzeiro['gols_sofridos'] / media_liga
    forca_of_int = internacional['gols_marcados'] / media_liga
    forca_def_int = internacional['gols_sofridos'] / media_liga
    
    print(f"‚Ä¢ Cruzeiro - For√ßa ofensiva: {forca_of_cru:.3f}")
    print(f"‚Ä¢ Cruzeiro - For√ßa defensiva: {forca_def_cru:.3f}")
    print(f"‚Ä¢ Internacional - For√ßa ofensiva: {forca_of_int:.3f}")
    print(f"‚Ä¢ Internacional - For√ßa defensiva: {forca_def_int:.3f}")
    
    # Gols esperados
    print(f"\n‚öΩ GOLS ESPERADOS (Modelo de Poisson):")
    
    gols_esp_cru = forca_of_cru * forca_def_int * media_liga * fator_casa
    gols_esp_int = forca_of_int * forca_def_cru * media_liga
    
    print(f"‚Ä¢ Cruzeiro: {forca_of_cru:.3f} √ó {forca_def_int:.3f} √ó {media_liga} √ó {fator_casa} = {gols_esp_cru:.2f}")
    print(f"‚Ä¢ Internacional: {forca_of_int:.3f} √ó {forca_def_cru:.3f} √ó {media_liga} = {gols_esp_int:.2f}")
    print(f"‚Ä¢ Total esperado: {gols_esp_cru + gols_esp_int:.2f} gols")
    
    # Calcular probabilidades usando Poisson
    print(f"\nüéØ PROBABILIDADES (Distribui√ß√£o de Poisson):")
    
    prob_vit_cru = 0
    prob_empate = 0
    prob_vit_int = 0
    
    # Simular at√© 6 gols para cada time (cobertura de ~99% dos casos)
    for gols_cru in range(7):
        for gols_int in range(7):
            # P(X=k) = (Œª^k * e^(-Œª)) / k!
            prob_cru = (gols_esp_cru ** gols_cru * math.exp(-gols_esp_cru)) / math.factorial(gols_cru)
            prob_int = (gols_esp_int ** gols_int * math.exp(-gols_esp_int)) / math.factorial(gols_int)
            prob_combinada = prob_cru * prob_int
            
            if gols_cru > gols_int:
                prob_vit_cru += prob_combinada
            elif gols_cru == gols_int:
                prob_empate += prob_combinada
            else:
                prob_vit_int += prob_combinada
    
    print(f"‚Ä¢ Vit√≥ria Cruzeiro: {prob_vit_cru:.1%} ({prob_vit_cru:.4f})")
    print(f"‚Ä¢ Empate: {prob_empate:.1%} ({prob_empate:.4f})")
    print(f"‚Ä¢ Vit√≥ria Internacional: {prob_vit_int:.1%} ({prob_vit_int:.4f})")
    print(f"‚Ä¢ Soma: {prob_vit_cru + prob_empate + prob_vit_int:.1%}")
    
    # An√°lise de odds
    print(f"\nüí∞ AN√ÅLISE DE ODDS:")
    
    prob_impl_cru = 1 / odds['cruzeiro']
    prob_impl_emp = 1 / odds['empate'] 
    prob_impl_int = 1 / odds['internacional']
    
    margem_casa = (prob_impl_cru + prob_impl_emp + prob_impl_int - 1) * 100
    
    print(f"‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê")
    print(f"‚îÇ Resultado     ‚îÇ Nossa Prob ‚îÇ Odd   ‚îÇ Prob Impl ‚îÇ Value Bet?    ‚îÇ")
    print(f"‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§")
    print(f"‚îÇ Cruzeiro      ‚îÇ {prob_vit_cru:>8.1%} ‚îÇ {odds['cruzeiro']:>5.2f} ‚îÇ {prob_impl_cru:>8.1%} ‚îÇ {'‚úÖ SIM' if prob_vit_cru > prob_impl_cru else '‚ùå N√ÉO':>11} ‚îÇ")
    print(f"‚îÇ Empate        ‚îÇ {prob_empate:>8.1%} ‚îÇ {odds['empate']:>5.2f} ‚îÇ {prob_impl_emp:>8.1%} ‚îÇ {'‚úÖ SIM' if prob_empate > prob_impl_emp else '‚ùå N√ÉO':>11} ‚îÇ")
    print(f"‚îÇ Internacional ‚îÇ {prob_vit_int:>8.1%} ‚îÇ {odds['internacional']:>5.2f} ‚îÇ {prob_impl_int:>8.1%} ‚îÇ {'‚úÖ SIM' if prob_vit_int > prob_impl_int else '‚ùå N√ÉO':>11} ‚îÇ")
    print(f"‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò")
    
    print(f"\nüìä VANTAGENS PERCENTUAIS:")
    vant_cru = (prob_vit_cru - prob_impl_cru) / prob_impl_cru * 100
    vant_emp = (prob_empate - prob_impl_emp) / prob_impl_emp * 100
    vant_int = (prob_vit_int - prob_impl_int) / prob_impl_int * 100
    
    print(f"‚Ä¢ Cruzeiro: {vant_cru:+.1f}%")
    print(f"‚Ä¢ Empate: {vant_emp:+.1f}%") 
    print(f"‚Ä¢ Internacional: {vant_int:+.1f}%")
    print(f"‚Ä¢ Margem da casa: {margem_casa:.2f}%")
    
    # Recomenda√ß√µes
    print(f"\nüéØ RECOMENDA√á√ïES:")
    
    recomendacoes = []
    if prob_vit_cru > prob_impl_cru and vant_cru > 5:
        recomendacoes.append(f"üî• FORTE: Apostar em Cruzeiro (Vantagem: {vant_cru:.1f}%)")
    if prob_empate > prob_impl_emp and vant_emp > 5:
        recomendacoes.append(f"üî• FORTE: Apostar em Empate (Vantagem: {vant_emp:.1f}%)")
    if prob_vit_int > prob_impl_int and vant_int > 5:
        recomendacoes.append(f"üî• FORTE: Apostar em Internacional (Vantagem: {vant_int:.1f}%)")
    
    if recomendacoes:
        for rec in recomendacoes:
            print(f"{rec}")
    else:
        print("‚ö†Ô∏è  N√£o foram encontrados value bets significativos (>5%)")
        print("   Aguarde melhores oportunidades ou odds mais favor√°veis")
    
    # Exemplo de aposta
    print(f"\nüí∏ EXEMPLO DE APOSTA:")
    valor_aposta = 100
    
    if recomendacoes:
        # Pegar a melhor recomenda√ß√£o (maior vantagem)
        if vant_cru > max(vant_emp, vant_int) and vant_cru > 5:
            retorno = valor_aposta * odds['cruzeiro']
            lucro = retorno - valor_aposta
            print(f"‚Ä¢ Apostar R$ {valor_aposta:.2f} em Cruzeiro")
            print(f"‚Ä¢ Retorno potencial: R$ {retorno:.2f}")
            print(f"‚Ä¢ Lucro potencial: R$ {lucro:.2f}")
            print(f"‚Ä¢ Probabilidade de ganhar: {prob_vit_cru:.1%}")
        elif vant_emp > max(vant_cru, vant_int) and vant_emp > 5:
            retorno = valor_aposta * odds['empate']
            lucro = retorno - valor_aposta
            print(f"‚Ä¢ Apostar R$ {valor_aposta:.2f} em Empate")
            print(f"‚Ä¢ Retorno potencial: R$ {retorno:.2f}")
            print(f"‚Ä¢ Lucro potencial: R$ {lucro:.2f}")
            print(f"‚Ä¢ Probabilidade de ganhar: {prob_empate:.1%}")
        elif vant_int > 5:
            retorno = valor_aposta * odds['internacional']
            lucro = retorno - valor_aposta
            print(f"‚Ä¢ Apostar R$ {valor_aposta:.2f} em Internacional")
            print(f"‚Ä¢ Retorno potencial: R$ {retorno:.2f}")
            print(f"‚Ä¢ Lucro potencial: R$ {lucro:.2f}")
            print(f"‚Ä¢ Probabilidade de ganhar: {prob_vit_int:.1%}")
    else:
        print("‚Ä¢ N√£o recomendado apostar neste confronto")
        print("‚Ä¢ Aguarde odds mais favor√°veis")
    
    print(f"\n{'='*80}")
    print("AN√ÅLISE CONCLU√çDA")
    print("Para usar a interface gr√°fica, execute: python interface_apostas.py")
    print(f"{'='*80}")

if __name__ == "__main__":
    calcular_exemplo_completo()
